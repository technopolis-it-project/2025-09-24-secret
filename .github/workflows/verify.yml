name: Verify Easter Egg Solution

on:
  push:
    branches: [ main, solution ]
  pull_request:
    branches: [ main ]

jobs:
  verify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–º–∏—Ç–æ–≤

      - name: Verify file structure
        run: |
          echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤..."
          if [ ! -f "index.html" ]; then
            echo "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç index.html"
            exit 1
          fi
          if [ ! -f "style.css" ]; then
            echo "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç style.css"
            exit 1
          fi
          if [ ! -f "script.js" ]; then
            echo "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç script.js"
            exit 1
          fi
          echo "‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ"

      - name: Check HTML content
        run: |
          echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º HTML..."
          if grep -q "generateFibonacci" index.html; then
            echo "‚úÖ –§—É–Ω–∫—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞ –≤ HTML"
          else
            echo "‚ùå –§—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ HTML"
            exit 1
          fi

      - name: Check CSS content
        run: |
          echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º CSS..."
          if grep -q "text-align: center" style.css; then
            echo "‚úÖ –°—Ç–∏–ª–∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã"
          else
            echo "‚ùå –°—Ç–∏–ª–∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
            exit 1
          fi

      - name: Check JavaScript logic
        run: |
          echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º JavaScript..."
          if grep -q "secret" script.js; then
            echo "‚úÖ –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ 'secret' –Ω–∞–π–¥–µ–Ω–æ"
          else
            echo "‚ùå –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ 'secret' –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
            exit 1
          fi
          
          if grep -q "L3Bhc3RlYmluLmNvbS9SYW5kb21TdHJpbmc=" script.js; then
            echo "‚úÖ Base64 —Å—Ç—Ä–æ–∫–∞ –Ω–∞–π–¥–µ–Ω–∞"
          else
            echo "‚ùå Base64 —Å—Ç—Ä–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
            exit 1
          fi

      - name: Check git history for secret commit
        run: |
          echo "üîç –ò—â–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç –≤ –∏—Å—Ç–æ—Ä–∏–∏..."
          if git log --all --oneline | grep -q "decoder hint"; then
            echo "‚úÖ –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç –Ω–∞–π–¥–µ–Ω –≤ –∏—Å—Ç–æ—Ä–∏–∏"
          elif git reflog | grep -q "decoder hint"; then
            echo "‚úÖ –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç –Ω–∞–π–¥–µ–Ω –≤ reflog"
          else
            echo "‚ö†Ô∏è –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω (–≤–æ–∑–º–æ–∂–Ω–æ, –µ—â–µ –Ω–µ –∏—Å–∫–∞–ª–∏)"
          fi

      - name: Success message
        run: |
          echo "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã."
          echo "üìã –ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –≤—Å–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ Pastebin –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–ª–∞–≥–∞."
          echo "üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ Base64 —Å—Ç—Ä–æ–∫–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –∏ JavaScript"